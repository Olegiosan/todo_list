{% extends "base.html" %}

{% block content %}
<div class="container my-4">
  <!-- –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ç–∞—Å–∫ -->
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-primary text-white">
      <h4 class="mb-0">{{ task.title }}</h4>
    </div>
    <div class="card-body">
      <p class="mb-1 text-muted">
        üë§ –°—Ç–≤–æ—Ä–∏–≤: <strong>{{ task.created_by }}</strong>
      </p>
      <hr>
      <h5 class="mb-3">üìå –î–µ—Ç–∞–ª—ñ</h5>
      <p>{{ task.description }}</p>
      <p>
        üîÑ –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–æ: <strong>{{ task.assigned_to }}</strong><br>
        üìÖ –î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è: <strong>{{ task.created_at }}</strong><br>
        ‚è≥ –î–µ–¥–ª–∞–π–Ω: <strong>{{ task.deadline }}</strong>
      </p>
    </div>
    <div class="card-footer text-end">
      <a class="btn btn-secondary" href="{% url 'board_info' task.status.board.pk %}">‚¨Ö –ù–∞–∑–∞–¥</a>
    </div>
  </div>

  <!-- –ö–æ–º–µ–Ω—Ç–∞—Ä—ñ -->
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-light">
      <h5 class="mb-0">üí¨ –ö–æ–º–µ–Ω—Ç–∞—Ä—ñ</h5>
    </div>
    <div class="card-body">
      {% if task.coments.all %}
        {% for coment in task.coments.all %}
          <div class="mb-3 border-bottom pb-2">
            <p class="mb-1"><strong>{{ coment.text }}</strong></p>
            {% if coment.images.all %}
              <div class="d-flex flex-wrap gap-2">
                {% for image in coment.images.all %}
                  <img src="{{ image.image.url }}" alt="Comment Image"
                       class="img-thumbnail" style="max-height: 100px;">
                {% endfor %}
              </div>
            {% endif %}
          </div>
        {% endfor %}
      {% else %}
        <p class="text-muted">–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤.</p>
      {% endif %}
    </div>
  </div>

  <!-- –§–æ—Ä–º–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ–º–µ–Ω—Ç–∞—Ä—è -->
  <div class="card shadow-sm">
    <div class="card-header bg-success text-white">
      <h5 class="mb-0">‚ûï –î–æ–¥–∞—Ç–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä</h5>
    </div>
    <div class="card-body">
      <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        {% for field in form %}
          <div class="mb-3">
            <label for="{{ field.id_for_label }}" class="form-label">
              {{ field.label }}
            </label>
            {{ field }}
            {% if field.errors %}
              <div class="text-danger small">
                {{ field.errors }}
              </div>
            {% endif %}
          </div>
        {% endfor %}
        <div class="mb-3">
          <label for="id_images" class="form-label">–î–æ–¥–∞—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è</label>
          <input type="file" name="images" id="id_images" multiple accept="image/*" class="form-control">
        </div>
        <button type="submit" class="btn btn-success w-100">‚úÖ –°—Ç–≤–æ—Ä–∏—Ç–∏</button>
      </form>
    </div>
  </div>
</div>
{% endblock %}
